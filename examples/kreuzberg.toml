
# Kreuzberg Configuration File (TOML)
# Place this file in one of the following locations:
# 1. Current directory: ./kreuzberg.toml
# 2. User config: ~/.config/kreuzberg/config.toml
# 3. System config: /etc/kreuzberg/config.toml
# Documentation: https://kreuzberg.dev/guides/configuration/

use_cache = true

enable_quality_processing = true

force_ocr = false

# NOTE: Server configuration (host, port, CORS) is loaded separately.
# ServerConfig is a separate type from ExtractionConfig.
# See: https://kreuzberg.dev/guides/api-server/ for server configuration examples.

[ocr]
backend = "tesseract"

language = "eng"

[ocr.tesseract_config]
psm = 3

oem = 3

min_confidence = 0.0

output_format = "text"

enable_table_detection = false

table_min_confidence = 0.5

table_column_threshold = 50

table_row_threshold_ratio = 0.5

use_cache = true

[ocr.tesseract_config.preprocessing]
target_dpi = 300

auto_rotate = true

deskew = true

denoise = true

contrast_enhance = true

binarization_method = "otsu"

invert_colors = false

[pdf_options]
extract_images = true

extract_metadata = true

# NEW in v4.0.0: PDF hierarchy extraction
[pdf_options.hierarchy]
enabled = true
k_clusters = 6
include_bbox = true
ocr_coverage_threshold = 0.5

[images]
extract_images = true

target_dpi = 300

max_image_dimension = 4096

auto_adjust_dpi = true

min_dpi = 72

max_dpi = 600

[chunking]
max_chars = 1000

max_overlap = 200

[chunking.embedding]
batch_size = 32

normalize = true

show_download_progress = true

cache_dir = "~/.cache/kreuzberg/embeddings"

# Option 1: Preset models (recommended)
[chunking.embedding.model]
type = "preset"
name = "balanced" # Options: balanced, fast, accurate, multilingual

# Option 2: FastEmbed models (requires embeddings feature)
# [chunking.embedding.model]
# type = "fastembed"
# model = "BAAI/bge-small-en-v1.5"
# dimensions = 384

# Option 3: Custom HuggingFace models
# [chunking.embedding.model]
# type = "custom"
# model_id = "sentence-transformers/all-mpnet-base-v2"
# dimensions = 768

# NEW in v4.0.0: Keyword extraction (requires keywords-yake or keywords-rake feature)
[keywords]
algorithm = "yake"
max_keywords = 10
min_score = 0.0
ngram_range = [1, 3]
language = "en"

# YAKE-specific parameters (optional)
# [keywords.yake_params]
# window_size = 2  # Window size for co-occurrence analysis (default: 2)

# RAKE-specific parameters (optional)
# [keywords.rake_params]
# min_word_length = 1        # Minimum word length to consider (default: 1)
# max_words_per_phrase = 3   # Maximum words in a keyword phrase (default: 3)

[token_reduction]
mode = "off"

preserve_important_words = true

[language_detection]
enabled = true

min_confidence = 0.8

detect_multiple = false

[postprocessor]
enabled = true
