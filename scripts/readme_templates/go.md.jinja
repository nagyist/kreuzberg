# Kreuzberg for Go

{% include 'partials/badges.html.jinja' %}

{{ description }}

> **Version {{ version }} Release Candidate**
> This binding targets the Kreuzberg {{ version }} APIs. Report issues at [github.com/kreuzberg-dev/kreuzberg](https://github.com/kreuzberg-dev/kreuzberg).

## Install

```bash
go get github.com/kreuzberg-dev/kreuzberg/packages/go/v4@latest
```

The Go binding uses cgo to link against the `kreuzberg-ffi` library.

## Quick Start

### Basic Usage

```go
package main

import (
	"fmt"
	"github.com/kreuzberg-dev/kreuzberg/packages/go/pkg/kreuzberg"
)

func main() {
	result, err := kreuzberg.ExtractFile("document.pdf")
	if err != nil {
		panic(err)
	}

	fmt.Println(result.Content)
}
```

### Async Extraction

```go
package main

import (
	"context"
	"fmt"
	"github.com/kreuzberg-dev/kreuzberg/packages/go/pkg/kreuzberg"
)

func main() {
	ctx := context.Background()
	result, err := kreuzberg.ExtractFileContext(ctx, "document.pdf")
	if err != nil {
		panic(err)
	}

	fmt.Println(result.Content)
}
```

### Batch Processing

```go
package main

import (
	"fmt"
	"github.com/kreuzberg-dev/kreuzberg/packages/go/pkg/kreuzberg"
)

func main() {
	files := []string{"doc1.pdf", "doc2.docx", "doc3.xlsx"}

	for _, file := range files {
		result, err := kreuzberg.ExtractFile(file)
		if err != nil {
			fmt.Printf("Error processing %s: %v\n", file, err)
			continue
		}

		fmt.Printf("%s: %d characters\n", file, len(result.Content))
	}
}
```

## Configuration

```go
package main

import (
	"context"
	"fmt"
	"github.com/kreuzberg-dev/kreuzberg/packages/go/pkg/kreuzberg"
)

func main() {
	ctx := context.Background()

	config := &kreuzberg.ExtractionConfig{
		UseCache: true,
		EnableQualityProcessing: true,
		OCR: &kreuzberg.OcrConfig{
			Backend: "tesseract",
			Language: "eng",
		},
	}

	result, err := kreuzberg.ExtractFileWithConfig(ctx, "document.pdf", config)
	if err != nil {
		panic(err)
	}

	fmt.Println(result.Content)
}
```

## OCR Support

### Tesseract Configuration

```go
package main

import (
	"fmt"
	"github.com/kreuzberg-dev/kreuzberg/packages/go/pkg/kreuzberg"
)

func main() {
	config := &kreuzberg.ExtractionConfig{
		OCR: &kreuzberg.OcrConfig{
			Backend: "tesseract",
			Language: "eng",
			TesseractConfig: &kreuzberg.TesseractConfig{
				PSM: 6,
				EnableTableDetection: true,
			},
		},
	}

	result, err := kreuzberg.ExtractFileWithConfig(nil, "scanned.pdf", config)
	if err != nil {
		panic(err)
	}

	fmt.Println(result.Content)
}
```

## Metadata Extraction

```go
package main

import (
	"fmt"
	"github.com/kreuzberg-dev/kreuzberg/packages/go/pkg/kreuzberg"
)

func main() {
	result, err := kreuzberg.ExtractFile("document.pdf")
	if err != nil {
		panic(err)
	}

	// Access metadata
	if metadata, ok := result.Metadata["pdf"].(map[string]interface{}); ok {
		if title, ok := metadata["title"].(string); ok {
			fmt.Printf("Title: %s\n", title)
		}
	}

	// Access tables
	for i, table := range result.Tables {
		fmt.Printf("Table %d:\n%s\n", i, table.Markdown)
	}
}
```

## API Reference

### Main Functions

- `ExtractFile(filePath string) (*ExtractionResult, error)` – Synchronous extraction
- `ExtractFileContext(ctx context.Context, filePath string) (*ExtractionResult, error)` – Context-aware extraction
- `ExtractFileWithConfig(ctx context.Context, filePath string, config *ExtractionConfig) (*ExtractionResult, error)` – With configuration
- `ExtractBytes(ctx context.Context, data []byte, mimeType string) (*ExtractionResult, error)` – From bytes
- `BatchExtractFiles(ctx context.Context, filePaths []string) ([]*ExtractionResult, error)` – Batch processing

### Configuration

- `ExtractionConfig` – Main configuration struct
- `OcrConfig` – OCR settings
- `TesseractConfig` – Tesseract-specific options
- `ChunkingConfig` – Text chunking settings

### Result Types

- `ExtractionResult` – Result with `Content`, `Metadata`, `Tables`, `DetectedLanguages`
- `ExtractedTable` – Table with `Cells`, `Markdown`, `PageNumber`

## Platform-Specific Build Instructions

### Linux/macOS

1. Build the Rust FFI crate:
   ```bash
   cargo build -p kreuzberg-ffi --release
   ```

2. Ensure the library is discoverable:
   ```bash
   export LD_LIBRARY_PATH=$PWD/target/release
   ```

### Windows (MinGW)

1. Build with core feature:
   ```bash
   cargo build -p kreuzberg-ffi --release --target x86_64-pc-windows-gnu --no-default-features --features core
   ```

2. Add to PATH:
   ```bash
   set PATH=%PATH%;target\x86_64-pc-windows-gnu\release
   ```

## Troubleshooting

### cgo compilation errors

Ensure you have the necessary build tools:

```bash
# macOS
xcode-select --install

# Ubuntu/Debian
sudo apt-get install build-essential

# Windows
# Install GCC via mingw-w64 or use MSVC toolchain
```

### Library not found at runtime

Set the appropriate library path:

```bash
# Linux
export LD_LIBRARY_PATH=$PWD/target/release

# macOS
export DYLD_FALLBACK_LIBRARY_PATH=$PWD/target/release

# Windows
set PATH=%PATH%;target\release
```

## Documentation

For comprehensive documentation, visit [https://kreuzberg.dev](https://kreuzberg.dev)

## License

{{ license }} License - see [LICENSE](../../LICENSE) for details.
